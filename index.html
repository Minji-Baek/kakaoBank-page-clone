<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./index.css">
  <title>About Minji</title>
</head>
<body>
  <div id="main-img-wrapper">
    <img width="320" src="./Lovepik_com-401339128-data-management-data-analysis-icon-free-vector-illustration-mate.png" 
    alt="coding img">
  </div>

  <div id="intro-main">
    <p>3년차 프론트 개발자, Min-Ji Baek</p>
    <p>함께 일해요!</p>
    <p id="join-us-test">Join Me!</p>
    <img id="down-arrow-icon" src="./down-arrow.png" alt="down arrow icon">
  </div>

  <ul id="list-item-wrapper">
    <li class="list-item">3년차</li>
    <li class="list-item">VUE</li>
    <li class="list-item">Front-end개발자</li>
    <li class="list-item">서울거주</li>
    <li class="list-item">컴퓨터공학전공</li>
    <li class="list-item">그래픽스논문</li>
    <li class="list-item">Git</li>
    <li class="list-item">React가능</li>
    <li class="list-item">TypeScript</li>
    <li class="list-item">JavaScript</li>
    <li class="list-item">C++</li>
    <li class="list-item">OpenGL</li>
    <li class="list-item">OpenCV</li>
    <li class="list-item">FastCampus</li>
    <li class="list-item">InteractiveWeb</li>
    <li class="list-item">Canvas</li>
    <li class="list-item">Three.js</li>
    <li class="list-item">Animation</li>
    <li class="list-item">Figma</li>
    <li class="list-item">potoshop</li>
    <li class="list-item">ppt</li>
    <li class="list-item">svn</li>
    <li class="list-item">vuetify</li>
  </ul>
  <main>
    <section id="panel1-img">
      <img id="flying-santa-image" src="./santa_flying.png" alt="santa flying">
    </section>

    <section id="video-section">
      <div id="fixed-wrapper">
        <video id="video" src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4"
          type="video/mp4" muted loop></video>
        <div id="fixed-description">
          <div>혁신이 만든</div>
          <div>압도적인 성장</div>
        </div>
      </div>
    </section>
  </main>

</body>

<script>
 
  // title & letter change
  const listStyleChangeStartY = 373;
  const listStyleChangeEndY = 1585;


  const listItems = document.querySelectorAll('.list-item');
  const division = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length; // 한 item 당 가지는 scoll 값

  //santa
  const panel1Img = document.getElementById('panel1-img');
  const flyingSantaImg = document.getElementById('flying-santa-image');
  //viedo
   const videoPlayBack = 500;

  const videoElement = document.getElementById('video');
  const videoSection = document.getElementById("video-section");

  const fixedWrapper = document.getElementById("fixed-wrapper");

  const fixedDescription = document.getElementById("fixed-description");

  const fixedDescriptionAppearTiming = 3470;
  const fixedDescriptionAppearEnds = 3800;


  //center fix function
  function centerElement(elementId, video) {
    const element = document.getElementById(elementId);
    const parent = element.parentElement;

    if (window.scrollY > parent.offsetTop - ((document.documentElement.clientHeight - element.offsetHeight) / 2)) { //중앙에 도착했을때,,,,
      element.style.position = "fixed";
      element.style.top = "50%"
      element.style.left = "50%"
      element.style.transform = "translate(-50%, -50%)"

      if (video) video.currentTime = (window.scrollY - videoSection.offsetTop) / videoPlayBack
    } else {
      element.style.position = "relative"
      element.style.top = "initial"
      element.style.left = "initial"
      element.style.transform = "initial"
    }
  }


  
  videoElement.addEventListener("loadedmetadata", () => {
    document.getElementById("video-section").style.height = videoElement.duration * videoPlayBack + "px";
  })


  //***********
  //scroll event
  window.addEventListener("scroll", () => {
    // console.log(document.getElementById("list-item-wrapper").offsetTop)
    
    // letter on&off
    if(document.getElementById("on")) 
      document.getElementById("on").removeAttribute("id")

    if(window.scrollY > listStyleChangeStartY && window.scrollY < listStyleChangeEndY ){
      const targetIndex = Math.round((window.scrollY - listStyleChangeStartY ) / division);
      if(listItems[targetIndex]) listItems[targetIndex].id="on";
    }
    

    //santa move event
    const scrollYBottom = window.scrollY + document.documentElement.clientHeight  //현재 스크롤 bottom 값
    if(scrollYBottom >  panel1Img.offsetTop && scrollYBottom < ( panel1Img.offsetTop + panel1Img.offsetHeight + 100 )) {
      // 각각의 숫자는 css에서 준 초기값이다.
      const translateX = 100 - 100 * 1.8 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);// 예상영역높이
      const translateY = 20 - 20 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);
      const rotationDegree = 30 - 30 * 1.8 * (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);
      
      flyingSantaImg.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotationDegree}deg)`;
      
    }

    centerElement("fixed-wrapper", videoElement)

    if (window.scrollY > videoSection.offsetTop + videoSection.offsetHeight - (fixedWrapper.offsetHeight + (document.documentElement.clientHeight - fixedWrapper.offsetHeight) / 2)) {
      fixedWrapper.style.position = "relative"
      fixedWrapper.style.top = "initial"
      fixedWrapper.style.left = "initial"
      fixedWrapper.style.transform = `translateY(${videoSection.offsetHeight - fixedWrapper.offsetHeight}px)`
    }

    if (window.scrollY > fixedDescriptionAppearTiming && window.scrollY < fixedDescriptionAppearEnds) {
      fixedDescription.style.transform = `translateY(${fixedDescriptionAppearEnds - window.scrollY}px)`

      fixedDescription.style.opacity = (window.scrollY - fixedDescriptionAppearTiming) / 300
    } else if (window.scrollY > fixedDescriptionAppearEnds) {
      fixedDescription.style.transform = `translateY(0px)`
      fixedDescription.style.opacity = 1
    } else {
      fixedDescription.style.transform = `translateY(100px)`
      fixedDescription.style.opacity = 0
    }



  })
</script>
</html>